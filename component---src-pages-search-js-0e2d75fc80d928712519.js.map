{"version":3,"sources":["webpack:///./src/pages/search.js","webpack:///./src/components/seo.js"],"names":["SearchPage","props","_this","_React$Component","call","this","getOrCreateIndex","index","Index","load","data","siteSearchIndex","state","query","results","search","_this2","expand","map","_ref2","ref","documentStore","getDoc","componentDidMount","queryString","parse","location","setState","getDerivedStateFromProps","nextProps","prevState","componentDidUpdate","prevProps","render","Object","_emotion_core__WEBPACK_IMPORTED_MODULE_3__","_components_layout__WEBPACK_IMPORTED_MODULE_6__","_components_seo__WEBPACK_IMPORTED_MODULE_7__","title","keywords","page","key","slug","gatsby__WEBPACK_IMPORTED_MODULE_5__","css","_ref","to","content","split","slice","join","React","Component","SEO","description","lang","meta","_emotion_core__WEBPACK_IMPORTED_MODULE_0__","detailsQuery","metaDescription","site","siteMetadata","react_helmet__WEBPACK_IMPORTED_MODULE_4___default","a","htmlAttributes","titleTemplate","name","property","concat","length","_public_static_d_1315885718_json__WEBPACK_IMPORTED_MODULE_1__","defaultProps","propTypes","PropTypes","string","array","arrayOf","isRequired"],"mappings":"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","file":"component---src-pages-search-js-0e2d75fc80d928712519.js","sourcesContent":["import React from \"react\";\r\nimport { Link } from \"gatsby\";\r\nimport { css } from \"@emotion/core\";\r\nimport Layout from \"../components/layout\";\r\nimport SEO from \"../components/seo\";\r\nimport { Index } from \"elasticlunr\";\r\nimport { graphql } from \"gatsby\";\r\nimport queryString from \"query-string\";\r\n\r\nexport default class SearchPage extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      query: \"\",\r\n      results: []\r\n    };\r\n  }\r\n\r\n  getOrCreateIndex = () =>\r\n    this.index\r\n      ? this.index\r\n      : // Create an elastic lunr index and hydrate with graphql query results\r\n        Index.load(this.props.data.siteSearchIndex.index);\r\n\r\n  search(query) {\r\n    this.index = this.getOrCreateIndex();\r\n    const results = this.index\r\n      // Query the index with search string to get an [] of IDs\r\n      .search(query, { expand: true })\r\n      // Map over each ID and return the full document\r\n      .map(({ ref }) => this.index.documentStore.getDoc(ref));\r\n\r\n    return results;\r\n  }\r\n\r\n  componentDidMount() {\r\n    const qs = queryString.parse(this.props.location.search);\r\n    const query = qs.query;\r\n    const results = this.search(query);\r\n    this.setState({\r\n      query: query,\r\n      results: results\r\n    });\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps, prevState) {\r\n    if (nextProps.location.search !== prevState.query) {\r\n      const qs = queryString.parse(nextProps.location.search);\r\n      const query = qs.query;\r\n      return { query: query };\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.location.search !== this.props.location.search) {\r\n      const qs = queryString.parse(this.props.location.search);\r\n      const query = qs.query;\r\n      const results = this.search(query);\r\n      this.setState({\r\n        query: query,\r\n        results: results\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Layout>\r\n        <SEO title=\"Search\" keywords={[`gatsby`, `application`, `react`]} />\r\n        <h1>Search Results for: {this.state.query}</h1>\r\n        {this.state.results.map(page => (\r\n          <li key={page.slug}>\r\n            <h2>\r\n              <Link\r\n                css={css`\r\n                  color: green;\r\n                `}\r\n                to={page.slug}\r\n              >\r\n                {page.title}\r\n              </Link>\r\n            </h2>\r\n            <p>\r\n              {page.content\r\n                .split(\" \")\r\n                .slice(0, 55)\r\n                .join(\" \") + \" ...\"}\r\n            </p>\r\n          </li>\r\n        ))}\r\n      </Layout>\r\n    );\r\n  }\r\n}\r\n\r\nexport const query = graphql`\r\n  query SearchIndexQuery {\r\n    siteSearchIndex {\r\n      index\r\n    }\r\n  }\r\n`;\r\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport Helmet from \"react-helmet\";\nimport { StaticQuery, graphql } from \"gatsby\";\n\nfunction SEO({ description, lang, meta, keywords, title }) {\n  return (\n    <StaticQuery\n      query={detailsQuery}\n      render={data => {\n        const metaDescription =\n          description || data.site.siteMetadata.description;\n        return (\n          <Helmet\n            htmlAttributes={{\n              lang\n            }}\n            title={title}\n            titleTemplate={`%s | ${data.site.siteMetadata.title}`}\n            meta={[\n              {\n                name: `description`,\n                content: metaDescription\n              },\n              {\n                property: `og:title`,\n                content: title\n              },\n              {\n                property: `og:description`,\n                content: metaDescription\n              },\n              {\n                property: `og:type`,\n                content: `website`\n              }\n            ]\n              .concat(\n                keywords.length > 0\n                  ? {\n                      name: `keywords`,\n                      content: keywords.join(`, `)\n                    }\n                  : []\n              )\n              .concat(meta)}\n          />\n        );\n      }}\n    />\n  );\n}\n\nSEO.defaultProps = {\n  lang: `en`,\n  meta: [],\n  keywords: []\n};\n\nSEO.propTypes = {\n  description: PropTypes.string,\n  lang: PropTypes.string,\n  meta: PropTypes.array,\n  keywords: PropTypes.arrayOf(PropTypes.string),\n  title: PropTypes.string.isRequired\n};\n\nexport default SEO;\n\nconst detailsQuery = graphql`\n  query DefaultSEOQuery {\n    site {\n      siteMetadata {\n        title\n        description\n      }\n    }\n  }\n`;\n"],"sourceRoot":""}